
Read the full code carefully and act as an experienced developer.

I want to improve the Calculation Page and the Load Condition Page workflow:

Send Processed Values to the Next Page
The Calculation page generates processed values such as:

Processed Sum → Vert (lbs), Trans (lbs), Long (lbs)

Example: 700.00, -2400.00, -48200.00, 48264.79
These calculated values must also be passed to the Load Condition page when the user clicks the Configure Load Conditions button.

Show Records Group-wise and Set-wise
On the Load Condition page, the records should display in two ways:

Group-wise (Imported Load Cases / Group Load Cases / Custom Groups)

Set-wise (new requirement)

Apply Overload Factors
On each record shown on the Load Condition page, I want to apply Overload Factors, similar to the existing logic already used on the Calculation page.

Overall Workflow Requirement

The Calculation page should process selected records.

The processed result values should be transferred to the Load Condition page.

The Load Condition page should display data grouped properly (group-wise + set-wise).

Overload factors must be applied to each record before performing further calculations.

Clearly mention/hint where to modify the code

this is view 
"def load_condition_view(request):
    calculation_data = []
    
    # Try to get calculation data from multiple sources
    if request.method == 'POST':
        # Get calculation data from POST request (initial load)
        calculation_data_json = request.POST.get('calculation_data')
        if calculation_data_json:
            try:
                calculation_data = json.loads(calculation_data_json)
                # Store in session for future requests
                request.session['calculation_data'] = calculation_data
            except json.JSONDecodeError:
                # Try to get from session if POST fails
                calculation_data = request.session.get('calculation_data', [])
    else:
        # For GET requests (like redirects from create/edit/delete), get from session
        calculation_data = request.session.get('calculation_data', [])
    
    # Get all load conditions
    load_conditions = LoadCondition.objects.all().order_by('id')
    
    # Get all attachment loads grouped by load case
    attachment_loads = {}
    for lc in AttachmentLoad.LOAD_CASE_CHOICES:
        loads = AttachmentLoad.objects.filter(load_case=lc[0]).order_by('attachment')
        if loads.exists():
            attachment_loads[lc[0]] = {
                'name': lc[1],
                'loads': loads
            }
    
    # Process calculation data only if it exists
    if calculation_data:
        # Add record_id and clean keys to calculation data for template access
        for index, record in enumerate(calculation_data):
            record['record_id'] = f"record_{index}"
            # Add clean keys for template access
            record['Structure_Loads_Vert'] = float(record.get('Structure Loads Vert. (lbs)', 0) or 0)
            record['Structure_Loads_Trans'] = float(record.get('Structure Loads Trans. (lbs)', 0) or 0)
            record['Structure_Loads_Long'] = float(record.get('Structure Loads Long. (lbs)', 0) or 0)
            record['Resultant'] = float(record.get('Resultant (lbs)', 0) or 0)
            # Store Set No. in data attribute
            record['Set_No'] = record.get('Set No.', 'Unknown')
        
        # Group calculation data by Set No. for debug display
        grouped_calculation_data = {}
        for record in calculation_data:
            set_no = record.get('Set No.', 'Unknown')
            if set_no not in grouped_calculation_data:
                grouped_calculation_data[set_no] = []
            grouped_calculation_data[set_no].append(record)
    else:
        grouped_calculation_data = {}
    
    # Calculate factored loads for each load condition (initially for all records)
    factored_loads_by_condition = {}
    
    if calculation_data:
        # Apply overload factor for each load condition to each record
        for condition in load_conditions:
            factored_records = []
            
            # Process each record individually
            for record in calculation_data:
                # Create a copy of the record
                factored_record = record.copy()
                
                # Extract the correct load values from the record
                vert = float(record.get('Structure Loads Vert. (lbs)', 0) or 0)
                trans = float(record.get('Structure Loads Trans. (lbs)', 0) or 0)
                long = float(record.get('Structure Loads Long. (lbs)', 0) or 0)
                
                # Apply overload factors - use Decimal for precise multiplication
                from decimal import Decimal
                factored_vert = Decimal(str(vert)) * Decimal(str(condition.vertical_factor))
                factored_trans = Decimal(str(trans)) * Decimal(str(condition.transverse_factor))
                factored_long = Decimal(str(long)) * Decimal(str(condition.longitudinal_factor))
                
                # Convert back to float for consistency
                factored_vert = float(factored_vert)
                factored_trans = float(factored_trans)
                factored_long = float(factored_long)
                
                # Update the record with factored values
                factored_record['Structure Loads Vert. (lbs)'] = round(factored_vert, 2)
                factored_record['Structure Loads Trans. (lbs)'] = round(factored_trans, 2)
                factored_record['Structure Loads Long. (lbs)'] = round(factored_long, 2)
                
                # Recalculate resultant
                factored_resultant = math.sqrt(factored_vert**2 + factored_trans**2 + factored_long**2)
                factored_record['Resultant (lbs)'] = round(factored_resultant, 2)
                
                factored_records.append(factored_record)
            
            # Group factored records by Set No.
            grouped_factored_data = {}
            for record in factored_records:
                set_no = record.get('Set No.', 'Unknown')
                if set_no not in grouped_factored_data:
                    grouped_factored_data[set_no] = []
                grouped_factored_data[set_no].append(record)
            
            factored_loads_by_condition[condition.description] = {
                'grouped_data': grouped_factored_data,
                'factors': {
                    'vertical': condition.vertical_factor,
                    'transverse': condition.transverse_factor,
                    'longitudinal': condition.longitudinal_factor
                },
                'all_records': factored_records  # Store all records for JavaScript filtering
            }
    
    context = {
        'load_conditions': load_conditions,
        'attachment_loads': attachment_loads,
        'calculation_data': calculation_data,
        'calculation_data_json': json.dumps(calculation_data),  # For JavaScript
        'factored_loads_by_condition': factored_loads_by_condition,
        'has_factored_loads': bool(factored_loads_by_condition),
        'grouped_calculation_data': grouped_calculation_data
    }
    
    return render(request, 'app1/load_condition.html', context)
"
this is load_condition.html 
"<div class="container">
        <header>
            <h2><i class="fas fa-table"></i> Load Conditions</h2>
            <p>Configure and apply load conditions to your calculations</p>
        </header>

        {% if calculation_data %}
        <!-- Selection Controls -->
        <div class="card">
            <h3><i class="fas fa-mouse-pointer"></i> Record Selection</h3>
            <div class="selection-controls">
                <button type="button" id="selectAllBtn" class="btn btn-outline-primary">
                    <i class="fas fa-check-square"></i> Select All
                </button>
                <button type="button" id="selectNoneBtn" class="btn btn-outline-secondary">
                    <i class="fas fa-square"></i> Select None
                </button>
                <span class="selection-count">Selected: <span id="selectedCount">{{ calculation_data|length }}</span> records</span>
            </div>
        </div>

        <div class="card">
            <h3><i class="fas fa-list-ol"></i> Calculation Data Records</h3>
            
            {% for set_no, records in grouped_calculation_data.items %}
            <div class="set-container">
                <div class="set-header">
                    <h4><i class="fas fa-cubes"></i> Set No. {{ set_no }} <span class="badge badge-primary">{{ records|length }} records</span></h4>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Select</th>
                                {% for key in records.0.keys %}
                                    {% if key != 'max_resultant_flag' and key != 'record_id' and key != 'Structure_Loads_Vert' and key != 'Structure_Loads_Trans' and key != 'Structure_Loads_Long' and key != 'Resultant' and key != 'Set_No' %}
                                        <th>{{ key }}</th>
                                    {% endif %}
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for record in records %}
                                <tr data-record-id="{{ record.record_id }}">
                                    <td>
                                        <input type="checkbox" class="record-checkbox" 
                                            data-record-id="{{ record.record_id }}"
                                            data-set-no="{{ record.Set_No }}"
                                            data-vert="{{ record.Structure_Loads_Vert }}"
                                            data-trans="{{ record.Structure_Loads_Trans }}"
                                            data-long="{{ record.Structure_Loads_Long }}"
                                            data-resultant="{{ record.Resultant }}"
                                            checked>
                                    </td>
                                    {% for key, value in record.items %}
                                        {% if key != 'max_resultant_flag' and key != 'record_id' and key != 'Structure_Loads_Vert' and key != 'Structure_Loads_Trans' and key != 'Structure_Loads_Long' and key != 'Resultant' and key != 'Set_No' %}
                                            {% if key == 'Resultant (lbs)' %}
                                                <td class="resultant-cell">{{ value }}</td>
                                            {% else %}
                                                <td>{{ value }}</td>
                                            {% endif %}
                                        {% endif %}
                                    {% endfor %}
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% if not forloop.last %}<hr>{% endif %}
            {% endfor %}
        </div>

        <!-- Custom Selection Results -->
        <div class="card">
            <h3><i class="fas fa-layer-group"></i> Selected Records Summary</h3>
            
            <div class="stats-grid" id="customSelectionStats">
                <!-- Will be populated by JavaScript -->
            </div>
            
            <div class="table-container">
                <table id="customSelectionTable">
                    <thead>
                        <tr>
                            <th>Set No.</th>
                            <th>Record ID</th>
                            <th>Vert (lbs)</th>
                            <th>Trans (lbs)</th>
                            <th>Long (lbs)</th>
                            <th>Resultant (lbs)</th>
                        </tr>
                    </thead>
                    <tbody id="customSelectionBody">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                    <tfoot id="customSelectionFooter">
                        <!-- Will be populated by JavaScript -->
                    </tfoot>
                </table>
            </div>
        </div>
        {% endif %}
        
        <div class="card">
            <h3><i class="fas fa-cog"></i> Load Condition Parameters</h3>
            
            <!-- Add Parameter Button -->
            <div class="action-buttons" style="justify-content: flex-start; margin-bottom: 20px;">
                <a href="{% url 'create_load_condition' %}" class="btn btn-primary">
                    <i class="fas fa-plus-circle"></i> Add New Parameter
                </a>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>°F</th>
                            <th>Radial (in)</th>
                            <th>Pressure (psf)</th>
                            <th>ANGLE</th>
                            <th>TRANSVERSE</th>
                            <th>VERTICAL</th>
                            <th>LONGITUDINAL</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for condition in load_conditions %}
                        <tr>
                            <td>{{ condition.description }}</td>
                            <td>{{ condition.temperature }}</td>
                            <td>{{ condition.ice_radial }}</td>
                            <td>{{ condition.wind_pressure }}</td>
                            <td>{{ condition.angle_factor }}</td>
                            <td>{{ condition.transverse_factor }}</td>
                            <td>{{ condition.vertical_factor }}</td>
                            <td>{{ condition.longitudinal_factor }}</td>
                            <td>
                                <div style="display: flex; gap: 5px;">
                                    <a href="{% url 'edit_load_condition' condition.pk %}" 
                                    class="btn btn-sm btn-outline-primary" 
                                    style="padding: 5px 10px; font-size: 0.8rem;">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <button onclick="deleteLoadCondition({{ condition.pk }})" 
                                            class="btn btn-sm btn-outline-danger" 
                                            style="padding: 5px 10px; font-size: 0.8rem;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="9" style="text-align: center; color: #6c757d;">
                                <i class="fas fa-info-circle"></i> No load conditions configured yet.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Factored Loads Section (Will be filtered by selection) -->
        <div id="factoredLoadsContainer">
            {% if has_factored_loads %}
            {% for condition_name, condition_data in factored_loads_by_condition.items %}
            <div class="card factored-loads-section" data-condition="{{ condition_name }}">
                <h3><i class="fas fa-calculator"></i> Factored Loads for {{ condition_name }}</h3>
                <p>Overload Factors: V×{{ condition_data.factors.vertical }}, 
                            T×{{ condition_data.factors.transverse }}, 
                            L×{{ condition_data.factors.longitudinal }}</p>
                
                <!-- This will be populated by JavaScript based on selection -->
                <div class="factored-results-container" id="factoredResults{{ forloop.counter }}">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
        
        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="window.history.back()">
                <i class="fas fa-arrow-left"></i> Back to Previous
            </button>
            <button class="btn btn-primary" onclick="window.print()">
                <i class="fas fa-print"></i> Print Report
            </button>
            <button class="btn btn-info" onclick="window.location.href='/'">
                <i class="fas fa-home"></i> Back to Home
            </button>
        </div>
    </div>



<footer>
    <p>Generated on {% now "F j, Y, g:i a" %} | Structural Analysis Tool</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Toggle buffer settings visibility
    const applyBufferCheckbox = document.getElementById('applyBuffer');
    const bufferSettings = document.getElementById('bufferSettings');
    
    applyBufferCheckbox.addEventListener('change', function() {
        bufferSettings.style.display = this.checked ? 'block' : 'none';
    });
    
    // Handle final calculation
    const calculateButton = document.getElementById('calculateFinalLoads');
    calculateButton.addEventListener('click', function() {
        // Get calculation data from previous step (you'll need to pass this from the previous view)
        const calculationData = JSON.parse('{{ calculation_data_json|escapejs }}' || '[]');
        
        // Get form data
        const formData = new FormData(document.getElementById('finalCalculationForm'));
        
        // Add calculation data to form data
        formData.append('calculation_data', JSON.stringify(calculationData));
        
        // Show loading indicator
        calculateButton.disabled = true;
        calculateButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Calculating...';
        
        // Send AJAX request
        fetch('{% url "calculate_final_loads" %}', {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Display results
                displayFinalResults(data.max_resultant_values);
            } else {
                alert('Error: ' + data.error);
            }
        })
        .catch(error => {
            alert('Error: ' + error.message);
        })
        .finally(() => {
            // Reset button
            calculateButton.disabled = false;
            calculateButton.innerHTML = '<i class="fas fa-calculator"></i> Calculate Final Loads';
        });
    });
    
    function displayFinalResults(results) {
        const tableBody = document.querySelector('#finalLoadsTable tbody');
        tableBody.innerHTML = '';
        
        let totalVert = 0;
        let totalTrans = 0;
        let totalLong = 0;
        
        for (const [setNo, values] of Object.entries(results)) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${setNo}</td>
                <td>${values.vert.toFixed(2)}</td>
                <td>${values.trans.toFixed(2)}</td>
                <td>${values.long.toFixed(2)}</td>
                <td>${values.resultant.toFixed(2)}</td>
            `;
            tableBody.appendChild(row);
            
            totalVert += values.vert;
            totalTrans += values.trans;
            totalLong += values.long;
        }
        
        // Add total row
        const totalResultant = Math.sqrt(totalVert**2 + totalTrans**2 + totalLong**2);
        const totalRow = document.createElement('tr');
        totalRow.classList.add('highlight');
        totalRow.innerHTML = `
            <td><strong>Total</strong></td>
            <td><strong>${totalVert.toFixed(2)}</strong></td>
            <td><strong>${totalTrans.toFixed(2)}</strong></td>
            <td><strong>${totalLong.toFixed(2)}</strong></td>
            <td><strong>${totalResultant.toFixed(2)}</strong></td>
        `;
        tableBody.appendChild(totalRow);
        
        // Show results section
        document.getElementById('finalResults').style.display = 'block';
    }
});
</script>

<script>
// Store factored loads data from Django
const factoredLoadsData = {
    {% for condition_name, condition_data in factored_loads_by_condition.items %}
    '{{ condition_name }}': {
        factors: {{ condition_data.factors|safe }},
        allRecords: {{ condition_data.all_records|safe }}
    },
    {% endfor %}
};

// Custom Selection Logic for Load Conditions Page
document.addEventListener('DOMContentLoaded', function() {
    initializeSelection();
});

function initializeSelection() {
    const checkboxes = document.querySelectorAll('.record-checkbox');
    const selectAllBtn = document.getElementById('selectAllBtn');
    const selectNoneBtn = document.getElementById('selectNoneBtn');
    const selectedCountSpan = document.getElementById('selectedCount');
    
    // Update selection count and display
    function updateSelection() {
        const selectedCheckboxes = document.querySelectorAll('.record-checkbox:checked');
        selectedCountSpan.textContent = selectedCheckboxes.length;
        
        // Update row styling
        checkboxes.forEach(checkbox => {
            const row = checkbox.closest('tr');
            if (checkbox.checked) {
                row.classList.add('selected-record');
            } else {
                row.classList.remove('selected-record');
            }
        });
        
        // Update custom selection display and factored loads
        updateCustomSelectionDisplay();
        updateFactoredLoadsDisplay();
    }
    
    // Select all records
    selectAllBtn.addEventListener('click', function() {
        checkboxes.forEach(checkbox => {
            checkbox.checked = true;
        });
        updateSelection();
    });
    
    // Select none
    selectNoneBtn.addEventListener('click', function() {
        checkboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
        updateSelection();
    });
    
    // Add event listeners to checkboxes
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updateSelection);
    });
    
    // Initial update
    updateSelection();
}

function updateCustomSelectionDisplay() {
    const selectedCheckboxes = document.querySelectorAll('.record-checkbox:checked');
    const statsGrid = document.getElementById('customSelectionStats');
    const tableBody = document.getElementById('customSelectionBody');
    const tableFooter = document.getElementById('customSelectionFooter');
    
    // Clear previous content
    statsGrid.innerHTML = '';
    tableBody.innerHTML = '';
    tableFooter.innerHTML = '';
    
    if (selectedCheckboxes.length === 0) {
        statsGrid.innerHTML = '<p>No records selected. Please select records using the checkboxes above.</p>';
        return;
    }
    
    let totalVert = 0;
    let totalTrans = 0;
    let totalLong = 0;
    const selectedRecords = [];
    
    // Process selected records
    selectedCheckboxes.forEach(checkbox => {
        const vert = parseFloat(checkbox.dataset.vert) || 0;
        const trans = parseFloat(checkbox.dataset.trans) || 0;
        const long = parseFloat(checkbox.dataset.long) || 0;
        const resultant = parseFloat(checkbox.dataset.resultant) || 0;
        const setNo = checkbox.dataset.setNo || 'Unknown';
        const recordId = checkbox.dataset.recordId;
        
        totalVert += vert;
        totalTrans += trans;
        totalLong += long;
        
        selectedRecords.push({
            setNo,
            recordId,
            vert,
            trans,
            long,
            resultant
        });
    });
    
    // Calculate final resultant
    const finalResultant = Math.sqrt(totalVert**2 + totalTrans**2 + totalLong**2);
    
    // Update stats grid
    statsGrid.innerHTML = `
        <div class="stat-card">
            <div class="stat-label">Selected Records</div>
            <div class="stat-value">${selectedCheckboxes.length}</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Total Vert</div>
            <div class="stat-value">${totalVert.toFixed(2)}</div>
            <div class="stat-label">(lbs)</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Total Trans</div>
            <div class="stat-value">${totalTrans.toFixed(2)}</div>
            <div class="stat-label">(lbs)</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Total Long</div>
            <div class="stat-value">${totalLong.toFixed(2)}</div>
            <div class="stat-label">(lbs)</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Resultant</div>
            <div class="stat-value">${finalResultant.toFixed(2)}</div>
            <div class="stat-label">(lbs)</div>
        </div>
    `;
    
    // Update table body
    selectedRecords.forEach(record => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${record.setNo}</td>
            <td>${record.recordId}</td>
            <td>${record.vert.toFixed(2)}</td>
            <td>${record.trans.toFixed(2)}</td>
            <td>${record.long.toFixed(2)}</td>
            <td>${record.resultant.toFixed(2)}</td>
        `;
        tableBody.appendChild(row);
    });
    
    // Update table footer with totals
    tableFooter.innerHTML = `
        <tr class="highlight">
            <td colspan="2"><strong>Selected Records Sum</strong></td>
            <td><strong>${totalVert.toFixed(2)}</strong></td>
            <td><strong>${totalTrans.toFixed(2)}</strong></td>
            <td><strong>${totalLong.toFixed(2)}</strong></td>
            <td><strong>${finalResultant.toFixed(2)}</strong></td>
        </tr>
    `;
    
    // Store current custom selection for further calculations
    window.currentCustomSelection = {
        totalVert,
        totalTrans,
        totalLong,
        finalResultant,
        selectedRecords
    };
}

function updateFactoredLoadsDisplay() {
    const selectedCheckboxes = document.querySelectorAll('.record-checkbox:checked');
    
    if (selectedCheckboxes.length === 0) {
        // Hide all factored loads sections
        document.querySelectorAll('.factored-loads-section').forEach(section => {
            section.style.display = 'none';
        });
        return;
    }
    
    // Get selected record IDs
    const selectedRecordIds = Array.from(selectedCheckboxes).map(checkbox => checkbox.dataset.recordId);
    
    // Process each load condition
    Object.keys(factoredLoadsData).forEach((conditionName, index) => {
        const conditionData = factoredLoadsData[conditionName];
        const container = document.getElementById(`factoredResults${index + 1}`);
        const section = document.querySelector(`.factored-loads-section[data-condition="${conditionName}"]`);
        
        if (!container || !section) return;
        
        // Filter records to only show selected ones
        const selectedFactoredRecords = conditionData.allRecords.filter(record => 
            selectedRecordIds.includes(record.record_id)
        );
        
        // Group by Set No.
        const groupedData = {};
        selectedFactoredRecords.forEach(record => {
            const setNo = record['Set No.'] || 'Unknown';
            if (!groupedData[setNo]) {
                groupedData[setNo] = [];
            }
            groupedData[setNo].push(record);
        });
        
        // Build HTML for factored loads
        let html = '';
        
        Object.keys(groupedData).forEach(setNo => {
            const records = groupedData[setNo];
            html += `
                <div class="set-container">
                    <div class="set-header">
                        <h4><i class="fas fa-cubes"></i> Set No. ${setNo} <span class="badge badge-primary">${records.length} records</span></h4>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
            `;
            
            // Add headers (exclude internal fields)
            if (records.length > 0) {
                Object.keys(records[0]).forEach(key => {
                    if (!['max_resultant_flag', 'record_id', 'Structure_Loads_Vert', 'Structure_Loads_Trans', 'Structure_Loads_Long', 'Resultant', 'Set_No'].includes(key)) {
                        html += `<th>${key}</th>`;
                    }
                });
            }
            
            html += `
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            // Add rows
            records.forEach(record => {
                html += `<tr>`;
                Object.keys(record).forEach(key => {
                    if (!['max_resultant_flag', 'record_id', 'Structure_Loads_Vert', 'Structure_Loads_Trans', 'Structure_Loads_Long', 'Resultant', 'Set_No'].includes(key)) {
                        const value = record[key];
                        if (key === 'Resultant (lbs)' || key.includes('Structure Loads')) {
                            html += `<td class="resultant-cell">${value}</td>`;
                        } else {
                            html += `<td>${value}</td>`;
                        }
                    }
                });
                html += `</tr>`;
            });
            
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        section.style.display = 'block';
    });
}

function deleteLoadCondition(pk) {
    if (confirm('Are you sure you want to delete this load condition?')) {
        // Create a form and submit it via POST
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/load-condition/${pk}/delete/`;
        
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]');
        if (csrfToken) {
            form.appendChild(csrfToken.cloneNode(true));
        } else {
            const csrfInput = document.createElement('input');
            csrfInput.type = 'hidden';
            csrfInput.name = 'csrfmiddlewaretoken';
            csrfInput.value = '{{ csrf_token }}';
            form.appendChild(csrfInput);
        }
        
        document.body.appendChild(form);
        form.submit();
    }
}
</script>"